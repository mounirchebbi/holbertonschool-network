#!/usr/bin/env bash
# Script that edits /etc/hosts:
# Resolve localhost to 127.0.0.2
# Resolve facebook.com to 8.8.8.8

set -e

# Backup the original /etc/hosts file (only once)
sudo cp /etc/hosts /etc/hosts.bak 2>/dev/null || true

# Remove any existing localhost line
sudo sed -i '/[[:space:]]localhost$/d' /etc/hosts

# Add new localhost mapping to 127.0.0.2
echo "127.0.0.2 localhost" | sudo tee -a /etc/hosts > /dev/null

# Add facebook.com to resolve to 8.8.8.8 if not already there
if ! grep -q "8.8.8.8 facebook.com" /etc/hosts; then
    echo "8.8.8.8 facebook.com" | sudo tee -a /etc/hosts > /dev/null
fi
